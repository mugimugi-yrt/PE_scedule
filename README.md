# 体育館施設利用調整シート作成 / gym-schedule sheet maker
author: mugi(Japanese)

## このプロジェクトの狙い
自分が所属している理工体育会の中で、施設利用予約について、Google Driveを用いてExcelファイルを共有し、そのExcelファイルに書き込みを行うという形で利用予約の希望を取っていた。しかし、それではiPhoneでの視認性が悪く、予約に少し手間がかかっていた。
pre-shift-managerでの開発経験を生かし、予約希望をGoogleフォームで提出、それをGoogleスプレッドシート上で調整を行うようにすることでより視認性の良い希望の取り方をした。さらにGoogleスプレッドシート上のデータを用いて施設利用表を作成することで見やすい施設利用表を自動で作成できるプログラムを入れた。使用言語はGoogle Apps Scriptとした。

## 用意するもの
### 調整用Googleスプレッドシート(ここに.gsコードを入れる)
プロジェクト内にある[gym_sheet.xlsx]を適当なGoogleスプレッドシートに入れる。このExcelシートをダウンロードすると、「FALSE」という文字列が並んでいる部分があると思うが、そこにはチェックボックスを入れる。また、このスプレッドシートの中に[sheet_maker.gs]を入れる。

gsコードのfolderIDとcoordinatieSpreadsheetIDを変えるのを忘れないようにする。また、次のフォームの回答の収集先をこのスプレッドシートにすること。

さらに、トリガーを以下のように設定する。
| 実行する関数  | デプロイ | イベントソース      | イベントの種類 | エラー通知 | 
| ------------ | ------- | ------------------ | ------------  | --------- |
| onCheck      |  Head   | スプレッドシートから |    編集時     |  (任意)    |
| onFormSubmit |  Head   | スプレッドシートから | フォーム送信時 |  (任意)    |

<注意事項>
+ 提出リストに並べている団体の数と「工体連団体(半角)」の右側の数は同じであるようにすること
+ 決定版の下の行の年と月の入力は正しくしないと施設利用表のカレンダーが狂うので作成するときは十分に注意すること

### 希望回収用Googleフォーム
用意する質問項目は次の通りである。

    1. 団体選択(プルダウン)※必須回答
    2. 施設利用をするかどうか(Yes/Noラジオボタン)※必須回答

    <もし施設を利用する(Yes)場合>
    3. 施設利用希望(チェックボックス(グリッド))※必須回答
    4. 備考(短文回答)

    <もし施設を利用しない(No)場合>
    3. 施設を利用しない理由(その他付ラジオボタン)※必須回答
    4. 質問(短文回答)

<注意事項>
+ 1.団体選択(プルダウン)とスプレッドシート上の提出リストは同じ内容になるようにする
+ 3.施設利用希望は以下のように「行を施設名」「列を曜日」にすること

|                | 月曜日 | 火曜日 | 水曜日 | 木曜日 | 金曜日 | 土曜日 | 日曜日 | 
| ------------   | ----- | ------ | ------ | ----- | ----- | ------ | ----- |
| 体育館          |       |        |       |       |        |        |       |
| 小体育館        |       |        |       |       |        |        |       |
| 屋外コート      |       |        |       |       |        |        |       |
| 緑町グラウンド   |       |        |       |       |        |        |       |
| 緑町テニスコート |       |        |       |       |        |        |       |

### 自動作成する施設利用表を入れる用のフォルダ
Googleドライブ上で作成すること。

## 使用方法
希望回収用Googleフォームで予約希望の回答を回収し、調整用Googleスプレッドシートの「決定版」の部分のセルに出てくるプルダウンを使って利用団体を決定する。調整が済んだら「利用表作成」と記載されている右側のチェックボックスをクリックするとポップアップが出てくるので、利用表を作りたい年月が正しければOKを選択して約1分ほど待てば施設利用表のGoogleスプレッドシートが完成する。

もしもフォーム回答のデータを削除したい場合は「リセット」と記載されている右側のチェックボックスをクリックするとデータを消すことができる。この時、同時にスプレッドシートの中のブックに同じデータのコピーを作る。

## 使用に当たって
このスプレッドシートとフォームを使った体育館施設利用調整システムは、私が所属している理工体育会のようにお金をかけて有料システムを使えないことから作成したシステムである。  
このコードは好きに利用していただいて構わないが、こちらに修正願を出されても対応できないのでバグが発生した場合は生成系AIや周りのプログラムに精通している人に解消してもらってほしい。
